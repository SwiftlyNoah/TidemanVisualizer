<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>How Tideman Works</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS + JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <!-- Font Awesome for social icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- Custom CSS -->
    <link href="styles.css" rel="stylesheet">
    <script src="script.js" defer></script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md navbar-dark bg-tideman">
        <a class="navbar-brand" href="index.html">Tideman Visualizer</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsMain" aria-controls="navbarsMain" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsMain">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="simulator.html">Simulator</a></li>
                <li class="nav-item active"><a class="nav-link" href="how-it-works.html">How It Works</a></li>
                <li class="nav-item"><a class="nav-link" href="code-walkthrough.html">Code Walkthrough</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
            </ul>
        </div>
    </nav>

    <main class="container" id="how-page">
        <header class="mt-4 mb-3">
            <h1>How the Tideman Algorithm Works</h1>
            <p>
                This page walks through a concrete example election with three candidates:
                <strong>Alice</strong>, <strong>Bob</strong>, and <strong>Charlie</strong>, using the same pipeline
                as the C implementation from CS50’s Tideman problem.
            </p>
        </header>

        <!-- Step 0: Inputs (VISIBLE by default) -->
        <section class="tideman-step card mb-4 visible">
            <div class="card-body">
                <h3 class="card-title">Step 0: Input to the Algorithm</h3>
                <p>
                    Tideman takes two main inputs:
                </p>
                <ul>
                    <li>A fixed list of <strong>candidates</strong>.</li>
                    <li>A collection of <strong>voter ballots</strong>, where each voter ranks all candidates from most to least preferred.</li>
                </ul>

                <p>In this example, we use:</p>

                <div class="row">
                    <div class="col-md-4">
                        <h5>Candidates</h5>
                        <ul>
                            <li>Alice</li>
                            <li>Bob</li>
                            <li>Charlie</li>
                        </ul>
                    </div>
                    <div class="col-md-8">
                        <h5>Voter Ballots</h5>
                        <p>Each row is one voter’s ranking from best (Rank 1) to worst (Rank 3):</p>
                        <div class="table-responsive">
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Voter</th>
                                        <th>Rank 1</th>
                                        <th>Rank 2</th>
                                        <th>Rank 3</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Voter 1</td>
                                        <td>Alice</td>
                                        <td>Bob</td>
                                        <td>Charlie</td>
                                    </tr>
                                    <tr>
                                        <td>Voter 2</td>
                                        <td>Bob</td>
                                        <td>Charlie</td>
                                        <td>Alice</td>
                                    </tr>
                                    <tr>
                                        <td>Voter 3</td>
                                        <td>Alice</td>
                                        <td>Charlie</td>
                                        <td>Bob</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="mb-0">
                            These ballots are exactly what the C program reads via repeated calls to <code>get_string</code>
                            and then converts into integer ranks with <code>vote</code>.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 1: Data structures -->
        <section class="tideman-step card mb-4">
            <div class="card-body">
                <h3 class="card-title">Step 1: Data Structures</h3>
                <p>
                    Tideman uses three key structures:
                </p>
                <ul>
                    <li><code>preferences[i][j]</code>: number of voters who prefer candidate <em>i</em> over <em>j</em>.</li>
                    <li><code>locked[i][j]</code>: <code>true</code> if there is a locked edge from <em>i</em> to <em>j</em> in the final graph.</li>
                    <li><code>pairs</code>: an array of all winner–loser pairs where one candidate beats another head-to-head.</li>
                </ul>

                <div class="table-responsive mt-3">
                    <table class="table table-sm table-bordered">
                        <thead>
                            <tr>
                                <th>Index</th>
                                <th>Candidate</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>0</td><td>Alice</td></tr>
                            <tr><td>1</td><td>Bob</td></tr>
                            <tr><td>2</td><td>Charlie</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Step 2: Record preferences -->
        <section class="tideman-step card mb-4">
            <div class="card-body">
                <h3 class="card-title">Step 2: Record Preferences</h3>
                <p>Using the same voter rankings as above:</p>
                <ul>
                    <li>Voter 1: Alice &gt; Bob &gt; Charlie</li>
                    <li>Voter 2: Bob &gt; Charlie &gt; Alice</li>
                    <li>Voter 3: Alice &gt; Charlie &gt; Bob</li>
                </ul>

                <p>
                    For each voter, the algorithm increments <code>preferences[ranks[i]][ranks[j]]</code>
                    for all <code>i &lt; j</code>.
                </p>

                <div class="table-responsive mt-3">
                    <table class="table table-sm table-bordered">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Alice</th>
                                <th>Bob</th>
                                <th>Charlie</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Alice</th>
                                <td>–</td>
                                <td>2</td>
                                <td>2</td>
                            </tr>
                            <tr>
                                <th scope="row">Bob</th>
                                <td>1</td>
                                <td>–</td>
                                <td>2</td>
                            </tr>
                            <tr>
                                <th scope="row">Charlie</th>
                                <td>1</td>
                                <td>1</td>
                                <td>–</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="mb-0">
                    For example, <code>preferences[Alice][Bob] = 2</code> means two voters prefer Alice over Bob.
                </p>
            </div>
        </section>

        <!-- Step 3: Add and sort pairs -->
        <section class="tideman-step card mb-4">
            <div class="card-body">
                <h3 class="card-title">Step 3: Build &amp; Sort Pairs</h3>
                <p>
                    For each unordered pair of candidates (i, j), the algorithm compares
                    <code>preferences[i][j]</code> vs <code>preferences[j][i]</code>.
                </p>

                <div class="table-responsive mt-3">
                    <table class="table table-sm table-striped">
                        <thead>
                            <tr>
                                <th>Winner</th>
                                <th>Loser</th>
                                <th>Votes for winner</th>
                                <th>Votes for loser</th>
                                <th>Strength</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Alice</td>
                                <td>Bob</td>
                                <td>2</td>
                                <td>1</td>
                                <td>+1</td>
                            </tr>
                            <tr>
                                <td>Alice</td>
                                <td>Charlie</td>
                                <td>2</td>
                                <td>1</td>
                                <td>+1</td>
                            </tr>
                            <tr>
                                <td>Bob</td>
                                <td>Charlie</td>
                                <td>2</td>
                                <td>1</td>
                                <td>+1</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="mb-0">
                    Pairs are then sorted in descending order of <strong>strength of victory</strong>.
                    Here all strengths are equal, so any order is fine.
                </p>
            </div>
        </section>

        <!-- Step 4: Lock pairs -->
        <section class="tideman-step card mb-4">
            <div class="card-body">
                <h3 class="card-title">Step 4: Lock Pairs, Avoid Cycles</h3>
                <p>
                    Pairs are considered from strongest to weakest. Each pair (winner → loser) is
                    <em>locked</em> as a directed edge unless doing so would create a cycle.
                </p>

                <p>Example locking sequence for our data:</p>
                <ol>
                    <li>Lock Alice → Bob (no cycle).</li>
                    <li>Lock Alice → Charlie (still no cycle).</li>
                    <li>Lock Bob → Charlie (no cycle).</li>
                </ol>

                <p>
                    This yields a graph where Alice has only outgoing edges.
                    She is the source of the graph.
                </p>
            </div>
        </section>

        <!-- Step 5: Winner -->
        <section class="tideman-step card mb-4">
            <div class="card-body">
                <h3 class="card-title">Step 5: Find the Winner</h3>
                <p>
                    Finally, Tideman scans for a candidate with no incoming edges in the locked graph.
                    That candidate is the winner of the election.
                </p>
                <p class="mb-0">
                    In this example, the winner is <strong>Alice</strong>, because no edges point into her
                    node in the locked graph.
                </p>
            </div>
        </section>

        <!-- Next step button -->
        <section class="mt-3 mb-5 text-center">
            <button class="btn btn-primary" id="step-next-btn">
                Show next step
            </button>
        </section>
    </main>

    <!-- Bootstrap Footer -->
    <footer class="text-center text-lg-start text-white" style="background-color: #A41D30;">
        <div class="container p-4">
            <div class="row">
                <!-- About -->
                <div class="col-lg-6 col-md-12 mb-4 mb-md-0 text-md-left">
                    <h5 class="text-uppercase">Tideman Election Visualizer</h5>
                    <p class="text-white-50">
                        An interactive demo of the Tideman ranked-choice algorithm,
                        built with HTML, CSS, JS, and Bootstrap, based on my initial code in C.
                    </p>
                </div>

                <!-- Socials -->
                <div class="col-lg-6 col-md-12 mb-4 mb-md-0 text-md-right">
                    <h6 class="text-uppercase mb-3">Connect</h6>
                    <a href="https://github.com/SwiftlyNoah" target="_blank" class="btn btn-outline-light btn-sm mx-1" title="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/noahbrauner/" target="_blank" class="btn btn-outline-light btn-sm mx-1" title="LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="mailto:nbrauner@college.harvard.edu" class="btn btn-outline-light btn-sm mx-1" title="Email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="text-center p-3" style="background-color: rgba(0,0,0,0.15); font-size: 0.9rem;">
            Created by <strong>Noah Brauner</strong> for CS50 2025 Problem Set 8
        </div>
    </footer>
</body>
</html>
